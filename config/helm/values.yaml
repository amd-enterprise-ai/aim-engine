# Default values for aim-engine
# This is a YAML-formatted file.
# Structure matches kubebuilder helm/v2-alpha plugin expectations

# Controller manager configuration
manager:
  replicas: 1

  # Image configuration
  image:
    repository: ghcr.io/amd-enterprise-ai/aim-engine
    tag: latest
    pullPolicy: IfNotPresent

  # Controller arguments
  args:
    - --leader-elect

  # Environment variables
  env: []

  # Pod-level security settings
  podSecurityContext:
    runAsNonRoot: true
    seccompProfile:
      type: RuntimeDefault

  # Container-level security settings
  securityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
    readOnlyRootFilesystem: true

  # Resource limits and requests
  resources:
    limits:
      cpu: 500m
      memory: 4Gi
    requests:
      cpu: 100m
      memory: 256Mi

# Helper RBAC roles for managing custom resources (admin/editor/viewer for each CRD)
rbacHelpers:
  enable: true

# Custom Resource Definitions
crd:
  enable: true
  keep: true  # Keep CRDs when uninstalling

# Controller metrics endpoint
metrics:
  enable: true
  port: 8443

# Cert-manager integration for TLS certificates
certManager:
  enable: false

# Prometheus ServiceMonitor for metrics scraping
prometheus:
  enable: false

# Cluster-wide runtime configuration for AIM resources
# Creates an AIMClusterRuntimeConfig CR when enabled
clusterRuntimeConfig:
  enable: false
  name: default

  # Spec fields for the AIMClusterRuntimeConfig
  spec:
    # Storage configuration defaults
    storage:
      # defaultStorageClassName: "standard"
      pvcHeadroomPercent: 100

    # HTTP routing configuration for inference services
    # routing:
    #   enabled: true
    #   gatewayRef:
    #     group: gateway.networking.k8s.io
    #     kind: Gateway
    #     name: aim-gateway
    #     namespace: kgateway-system
    #   pathTemplate: "/{.metadata.namespace}/{.metadata.name}"
      # annotations: {}

    # Model discovery configuration
    # model:
    #   autoDiscovery: true

    # Environment variables (for runtime config, not propagated to child resources)
    # env: []

    # Label propagation to child resources
    # labelPropagation:
    #   enabled: true
    #   match:
    #     - "aim.eai.amd.com/*"
